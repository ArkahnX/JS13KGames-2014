function o(o,r,e){null!==o.img&&context.drawImage(o.img,o.x||r,o.y||e,o.w,o.h)}function r(o,r,e,n){vr[r][e]||(o[e]=n,vr[r][e]=n),vr[r][e]!==n&&(o[e]=n,vr[r][e]=n)}function e(){for(var o=(se[0].width,se[0].height,10*se[0].size),r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&t(e,r,se[0].map,o,1,1);for(var r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&drawTile(e,r,se[0].map,o,1,1)}function n(){Wr.fillStyle="#FF9900",r(Fr,"border","strokeStyle","#ff0000"),r(Fr,"border","lineWidth",2);var o=window.performance.now(),e=M(qr)-1,n=M(Kr)-1,i=M(qr)+M(Mr.width)+2,s=M(Kr)+M(Mr.height)+2;0>e&&(e=0),0>n&&(n=0),i>oe&&(i=oe),s>oe&&(s=oe);for(var d=n;s>d;d++)for(var m,p=0,c=16*-oe*2,u=0,h=e;i>h;h++)0!==pe[T(h,d,oe)]&&(p+=16,c===16*-oe*2&&(c=16*h-qr),m=0>d-1?-1:pe[T(h,d-1,oe)],0===m&&(u=1)),(0===pe[T(h,d,oe)]||h===i-1)&&t(h,d,pe,oe,c,p,u),(0===pe[T(h,d,oe)]||h===i-1)&&(p=0,c=16*-oe*2,u=0);a(e,n,i,s,1),a(e,n,i,s,4),l(e,n,i,s,2),l(e,n,i,s,8);var g=window.performance.now()-o;g>Rr&&(Rr=g)}function t(o,r,e,n,t,a,l){var i=t,s=16*r-Kr;1===l?Wr.fillRect(i,s-5,a,21):Wr.fillRect(i,s,a,16)}function a(o,r,e,n,t){for(var a=o;e>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=r;n>p;p++){var c=pe[T(a+1,p-1,oe)],u=pe[T(a,p-1,oe)],h=pe[T(a-1,p-1,oe)];if(1===t?(m=pe[T(a-1,p,oe)],0>a-1&&(m=-1)):4===t&&(m=pe[T(a+1,p,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(a,p,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(0===u&&(d=1),s=16*p-Kr)),0===pe[T(a,p,oe)]||p===n-1||m>0){Fr.beginPath();var g=s,f=16*a-qr,y=g+l,w=16*(a+1)-qr,x=f;4===t&&(x=w),d&&(g-=5),(4===t&&0===c||1===t&&0===h)&&m>0?i(x,g,x,y+3):i(x,g,x,y),Fr.closePath(),Fr.stroke()}(0===pe[T(a,p,oe)]||p===n-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function l(o,r,e,n,t){for(var a=r;n>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=o;e>p;p++){if(2===t?0>a-1?m=-1:(m=pe[T(p,a-1,oe)],d=1):8===t&&(m=pe[T(p,a+1,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(p,a,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(s=16*p-qr)),0===pe[T(p,a,oe)]||p===e-1||m>0){Fr.beginPath();var c=s,u=16*a-Kr,h=c+l,g=16*(a+1)-Kr;2===t?1===d?(i(c,u-5,h,u-5),i(c,u+3,h,u+3)):i(c,u,h,u):8===t&&i(c,g,h,g),Fr.closePath(),Fr.stroke()}(0===pe[T(p,a,oe)]||p===e-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function i(o,r,e,n){Fr.moveTo(o,r),Fr.lineTo(e,n)}function s(){var o=null;Dr.width=16*Xe.width,Dr.height=16*Xe.height,Ar.clearRect(0,0,Dr.width,Dr.height);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],Ar.lineWidth=2,Ar.strokeStyle=o.region.color.border,Ar.fillStyle=o.region.color.background,Ar.rect(16*o.mapX,16*o.mapY,16*o.mapW,16*o.mapH),Ar.fill(),Ar.stroke(),p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],d(o)}function d(o){for(var r=null,e=0;e<o.doors.length;e++){r=o.doors[e];var n=Ae[r.doorType].lock;if(r.doorType>0)switch(r.dir){case"N":m(16*r.mapX+5,16*r.mapY,n);continue;case"S":m(16*r.mapX+5,16*r.mapY+16,n);continue;case"W":m(16*r.mapX-3,16*r.mapY+8,n);continue;case"E":m(16*r.mapX+13,16*r.mapY+8,n);continue;default:continue}}var n=Ae[o.specialType].lock;o.specialType>0&&m(16*(o.mapX+o.mapW/2)-3,16*(o.mapY+o.mapH/2),"rgba(0,0,0,0)",n)}function m(o,r,e,n){var t=3;Ar.beginPath(),Ar.arc(o+t,r,t,0,2*Math.PI,!1),Ar.fillStyle=e,Ar.fill(),n&&(Ar.lineWidth=2,Ar.strokeStyle=n,Ar.stroke())}function p(o){var r=null;Ar.lineWidth=1;for(var e=4,n=0;n<o.doors.length;n++)switch(r=o.doors[n],r.dir){case"N":var t="#FF0000";Ar.strokeStyle=t,c(16*r.mapX+e,16*r.mapY+2,16*r.mapX+16-e,16*r.mapY+2,t);continue;case"S":var t="#00FF00";Ar.strokeStyle=t,c(16*r.mapX+e,16*(r.mapY+1),16*r.mapX+16-e,16*(r.mapY+1),t);continue;case"W":var t="#0000FF";Ar.strokeStyle=t,c(16*r.mapX+2,16*r.mapY+e,16*r.mapX+2,16*r.mapY+16-e,t);continue;case"E":var t="#FFFF00";Ar.strokeStyle=t,c(16*(r.mapX+1),16*r.mapY+e,16*(r.mapX+1),16*r.mapY+16-e,t);continue;default:continue}}function c(o,r,e,n){Ar.beginPath(),Ar.moveTo(o,r),Ar.lineTo(e,n),Ar.stroke(),Ar.closePath()}function u(){var o=null,r=0;Ar.fillStyle="rgba(255,255,255,0.3)";for(var e=q();r<e.length;)o=e[r],Ar.fillRect(16*o.x,16*o.y,16,16),drawRectangle(O(o.x,o.y,1,1,null)),r++}function o(o,r,e){null!==o.img&&context.drawImage(o.img,o.x||r,o.y||e,o.w,o.h)}function r(o,r,e,n){vr[r][e]||(o[e]=n,vr[r][e]=n),vr[r][e]!==n&&(o[e]=n,vr[r][e]=n)}function e(){for(var o=(se[0].width,se[0].height,10*se[0].size),r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&t(e,r,se[0].map,o,1,1);for(var r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&drawTile(e,r,se[0].map,o,1,1)}function n(){Wr.fillStyle="#FF9900",r(Fr,"border","strokeStyle","#ff0000"),r(Fr,"border","lineWidth",2);var o=window.performance.now(),e=M(qr)-1,n=M(Kr)-1,i=M(qr)+M(Mr.width)+2,s=M(Kr)+M(Mr.height)+2;0>e&&(e=0),0>n&&(n=0),i>oe&&(i=oe),s>oe&&(s=oe);for(var d=n;s>d;d++)for(var m,p=0,c=16*-oe*2,u=0,h=e;i>h;h++)0!==pe[T(h,d,oe)]&&(p+=16,c===16*-oe*2&&(c=16*h-qr),m=0>d-1?-1:pe[T(h,d-1,oe)],0===m&&(u=1)),(0===pe[T(h,d,oe)]||h===i-1)&&t(h,d,pe,oe,c,p,u),(0===pe[T(h,d,oe)]||h===i-1)&&(p=0,c=16*-oe*2,u=0);a(e,n,i,s,1),a(e,n,i,s,4),l(e,n,i,s,2),l(e,n,i,s,8);var g=window.performance.now()-o;g>Rr&&(Rr=g)}function t(o,r,e,n,t,a,l){var i=t,s=16*r-Kr;1===l?Wr.fillRect(i,s-5,a,21):Wr.fillRect(i,s,a,16)}function a(o,r,e,n,t){for(var a=o;e>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=r;n>p;p++){var c=pe[T(a+1,p-1,oe)],u=pe[T(a,p-1,oe)],h=pe[T(a-1,p-1,oe)];if(1===t?(m=pe[T(a-1,p,oe)],0>a-1&&(m=-1)):4===t&&(m=pe[T(a+1,p,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(a,p,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(0===u&&(d=1),s=16*p-Kr)),0===pe[T(a,p,oe)]||p===n-1||m>0){Fr.beginPath();var g=s,f=16*a-qr,y=g+l,w=16*(a+1)-qr,x=f;4===t&&(x=w),d&&(g-=5),(4===t&&0===c||1===t&&0===h)&&m>0?i(x,g,x,y+3):i(x,g,x,y),Fr.closePath(),Fr.stroke()}(0===pe[T(a,p,oe)]||p===n-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function l(o,r,e,n,t){for(var a=r;n>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=o;e>p;p++){if(2===t?0>a-1?m=-1:(m=pe[T(p,a-1,oe)],d=1):8===t&&(m=pe[T(p,a+1,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(p,a,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(s=16*p-qr)),0===pe[T(p,a,oe)]||p===e-1||m>0){Fr.beginPath();var c=s,u=16*a-Kr,h=c+l,g=16*(a+1)-Kr;2===t?1===d?(i(c,u-5,h,u-5),i(c,u+3,h,u+3)):i(c,u,h,u):8===t&&i(c,g,h,g),Fr.closePath(),Fr.stroke()}(0===pe[T(p,a,oe)]||p===e-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function i(o,r,e,n){Fr.moveTo(o,r),Fr.lineTo(e,n)}function s(){var o=null;Mr.width=16*Xe.width,Mr.height=16*Xe.height,Yr.clearRect(0,0,Mr.width,Mr.height);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],Yr.lineWidth=3,Yr.strokeStyle=o.region.color.border,Yr.fillStyle=o.region.color.background,Yr.rect(16*o.mapX,16*o.mapY,16*o.mapW,16*o.mapH),Yr.fill(),Yr.stroke(),p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],d(o)}function d(o){for(var r=null,e=0;e<o.doors.length;e++){r=o.doors[e];var n=Ae[r.doorType].lock;if(r.doorType>0)switch(r.dir){case"N":m(16*r.mapX+5,16*r.mapY,n);continue;case"S":m(16*r.mapX+5,16*r.mapY+16,n);continue;case"W":m(16*r.mapX-3,16*r.mapY+8,n);continue;case"E":m(16*r.mapX+13,16*r.mapY+8,n);continue;default:continue}}var n=Ae[o.specialType].lock;o.specialType>0&&m(16*(o.mapX+o.mapW/2)-3,16*(o.mapY+o.mapH/2),"rgba(0,0,0,0)",n)}function m(o,r,e,n){var t=3;Yr.beginPath(),Yr.arc(o+t,r,t,0,2*Math.PI,!1),Yr.fillStyle=e,Yr.fill(),n&&(Yr.lineWidth=2,Yr.strokeStyle=n,Yr.stroke())}function p(o){var r=null,e=o.region.color.background;Yr.lineWidth=1,Yr.strokeStyle=e;for(var n=4,t=0;t<o.doors.length;t++)switch(r=o.doors[t],r.dir){case"N":c(16*r.mapX+n,16*r.mapY-2,16*r.mapX+16-n,16*r.mapY-2,e);continue;case"S":c(16*r.mapX+n,16*(r.mapY+1),16*r.mapX+16-n,16*(r.mapY+1),e);continue;case"W":c(16*r.mapX,16*r.mapY+n,16*r.mapX,16*r.mapY+16-n,e);continue;case"E":c(16*(r.mapX+1),16*r.mapY+n,16*(r.mapX+1),16*r.mapY+16-n,e);continue;default:continue}}function c(o,r,e,n){Yr.beginPath(),Yr.moveTo(o,r),Yr.lineTo(e,n),Yr.stroke(),Yr.closePath()}function u(){var o=null,r=0;Yr.fillStyle="rgba(255,255,255,0.3)";for(var e=q();r<e.length;)o=e[r],Yr.fillRect(16*o.x,16*o.y,16,16),drawRectangle(O(o.x,o.y,1,1,null)),r++}function o(o,r,e){null!==o.img&&context.drawImage(o.img,o.x||r,o.y||e,o.w,o.h)}function r(o,r,e,n){vr[r][e]||(o[e]=n,vr[r][e]=n),vr[r][e]!==n&&(o[e]=n,vr[r][e]=n)}function e(){for(var o=(se[0].width,se[0].height,10*se[0].size),r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&t(e,r,se[0].map,o,1,1);for(var r=0;o>r;r++)for(var e=0;o>e;e++)0!==se[0].map[T(e,r,o)]&&drawTile(e,r,se[0].map,o,1,1)}function n(){Wr.fillStyle="#FF9900",r(Fr,"border","strokeStyle","#ff0000"),r(Fr,"border","lineWidth",2);var o=window.performance.now(),e=M(qr)-1,n=M(Kr)-1,i=M(qr)+M(Mr.width)+2,s=M(Kr)+M(Mr.height)+2;0>e&&(e=0),0>n&&(n=0),i>oe&&(i=oe),s>oe&&(s=oe);for(var d=n;s>d;d++)for(var m,p=0,c=16*-oe*2,u=0,h=e;i>h;h++)0!==pe[T(h,d,oe)]&&(p+=16,c===16*-oe*2&&(c=16*h-qr),m=0>d-1?-1:pe[T(h,d-1,oe)],0===m&&(u=1)),(0===pe[T(h,d,oe)]||h===i-1)&&t(h,d,pe,oe,c,p,u),(0===pe[T(h,d,oe)]||h===i-1)&&(p=0,c=16*-oe*2,u=0);a(e,n,i,s,1),a(e,n,i,s,4),l(e,n,i,s,2),l(e,n,i,s,8);var g=window.performance.now()-o;g>Rr&&(Rr=g)}function t(o,r,e,n,t,a,l){var i=t,s=16*r-Kr;1===l?Wr.fillRect(i,s-5,a,21):Wr.fillRect(i,s,a,16)}function a(o,r,e,n,t){for(var a=o;e>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=r;n>p;p++){var c=pe[T(a+1,p-1,oe)],u=pe[T(a,p-1,oe)],h=pe[T(a-1,p-1,oe)];if(1===t?(m=pe[T(a-1,p,oe)],0>a-1&&(m=-1)):4===t&&(m=pe[T(a+1,p,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(a,p,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(0===u&&(d=1),s=16*p-Kr)),0===pe[T(a,p,oe)]||p===n-1||m>0){Fr.beginPath();var g=s,f=16*a-qr,y=g+l,w=16*(a+1)-qr,x=f;4===t&&(x=w),d&&(g-=5),(4===t&&0===c||1===t&&0===h)&&m>0?i(x,g,x,y+3):i(x,g,x,y),Fr.closePath(),Fr.stroke()}(0===pe[T(a,p,oe)]||p===n-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function l(o,r,e,n,t){for(var a=r;n>a;a++)for(var l=0,s=16*-oe*2,d=0,m=0,p=o;e>p;p++){if(2===t?0>a-1?m=-1:(m=pe[T(p,a-1,oe)],d=1):8===t&&(m=pe[T(p,a+1,oe)],a+1>oe-1&&(m=-1)),0!==pe[T(p,a,oe)]&&1>m&&(l+=16,s===16*-oe*2&&(s=16*p-qr)),0===pe[T(p,a,oe)]||p===e-1||m>0){Fr.beginPath();var c=s,u=16*a-Kr,h=c+l,g=16*(a+1)-Kr;2===t?1===d?(i(c,u-5,h,u-5),i(c,u+3,h,u+3)):i(c,u,h,u):8===t&&i(c,g,h,g),Fr.closePath(),Fr.stroke()}(0===pe[T(p,a,oe)]||p===e-1||m>0)&&(l=0,s=16*-oe*2,d=0)}}function i(o,r,e,n){Fr.moveTo(o,r),Fr.lineTo(e,n)}function s(){var o=null;Mr.width=16*Xe.width,Mr.height=16*Xe.height,Yr.clearRect(0,0,Mr.width,Mr.height);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],Yr.lineWidth=3,Yr.strokeStyle=o.region.color.border,Yr.fillStyle=o.region.color.background,Yr.rect(16*o.mapX,16*o.mapY,16*o.mapW,16*o.mapH),Yr.fill(),Yr.stroke(),p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],p(o);for(var r=0;r<Xe.rooms.length;r++)o=Xe.rooms[r],d(o)}function d(o){for(var r=null,e=0;e<o.doors.length;e++){r=o.doors[e];var n=Ae[r.doorType].lock;if(r.doorType>0)switch(r.dir){case"N":m(16*r.mapX+5,16*r.mapY,n);continue;case"S":m(16*r.mapX+5,16*r.mapY+16,n);continue;case"W":m(16*r.mapX-3,16*r.mapY+8,n);continue;case"E":m(16*r.mapX+13,16*r.mapY+8,n);continue;default:continue}}var n=Ae[o.specialType].lock;o.specialType>0&&m(16*(o.mapX+o.mapW/2)-3,16*(o.mapY+o.mapH/2),"rgba(0,0,0,0)",n)}function m(o,r,e,n){var t=3;Yr.beginPath(),Yr.arc(o+t,r,t,0,2*Math.PI,!1),Yr.fillStyle=e,Yr.fill(),n&&(Yr.lineWidth=2,Yr.strokeStyle=n,Yr.stroke())}function p(o){var r=null;Yr.lineWidth=1;for(var e=4,n=0;n<o.doors.length;n++)switch(r=o.doors[n],r.dir){case"N":var t="#FF0000";Yr.strokeStyle=t,c(16*r.mapX+e,16*r.mapY+2,16*r.mapX+16-e,16*r.mapY+2,t);continue;case"S":var t="#00FF00";Yr.strokeStyle=t,c(16*r.mapX+e,16*(r.mapY+1),16*r.mapX+16-e,16*(r.mapY+1),t);continue;case"W":var t="#0000FF";Yr.strokeStyle=t,c(16*r.mapX+2,16*r.mapY+e,16*r.mapX+2,16*r.mapY+16-e,t);continue;case"E":var t="#000000";Yr.strokeStyle=t,c(16*(r.mapX+1),16*r.mapY+e,16*(r.mapX+1),16*r.mapY+16-e,t);continue;default:continue}}function c(o,r,e,n){Yr.beginPath(),Yr.moveTo(o,r),Yr.lineTo(e,n),Yr.stroke(),Yr.closePath()}function u(){var o=null,r=0;Yr.fillStyle="rgba(255,255,255,0.3)";for(var e=q();r<e.length;)o=e[r],Yr.fillRect(16*o.x,16*o.y,16,16),drawRectangle(O(o.x,o.y,1,1,null)),r++}function h(o,r){Or[o]||(Or[o]=[]),Or[o].push(r)}function g(o,r,e,n,t,a){var l={x:o,y:r,w:e,h:n,angle:0,img:t};return a&&(l.xDirection=0,l.yDirection=0,l.xAccel=0,l.yAccel=1,l.maxAccel=5),a&&(l.jumpForce=7,l.jumpHeight=50,l.jumpStart=0,l.jumping=0,l.jumpsUsed=0,l.maxJumps=3),l}function f(o){var r=o.type;if(Or[r]&&Or[r].length>0)for(var e=0;e<Or[r].length;e++)Or[r][e](o)}function y(o,r){return document[br[o]](r)}function w(){Mr=y(kr,"player"),Xr=y(kr,"border"),Tr=y(kr,"tile"),Dr=y(kr,"minimap"),Yr=Mr.getContext("2d"),Fr=Xr.getContext("2d"),Wr=Tr.getContext("2d"),Ar=Dr.getContext("2d"),x(),R(),fr(),s()}function x(){Xr.width=Mr.width=Tr.width=Dr.width=window.innerWidth>300?300:window.innerWidth,Xr.height=Mr.height=Tr.height=Dr.width=window.innerHeight>300?300:window.innerHeight}function v(){for(var o=0;o<zr.length;o++){var e=zr[o];L(e),e.x=Y(e.x),e.y=Y(e.y),S(e),I(e),H(e),B(e)}z(),Yr.clearRect(0,0,Mr.width,Mr.height),Fr.clearRect(0,0,Xr.width,Xr.height),r(Wr,"tile","fillStyle","#000000"),Wr.fillRect(0,0,Tr.width,Tr.height),Wr.clearRect(0-qr,0-Kr,te,ne),n(),Yr.fillStyle="#000000";for(var o=0;o<zr.length;o++){var e=zr[o],t=(15-15*(jr.health/jr.maxHealth)).toString(16);Yr.fillStyle="#"+t+t+"0000",Yr.fillRect(e.x-qr,e.y-Kr,e.w,e.h)}}function R(){Ir=window.performance.now(),Nr=Ir-Sr,Sr=Ir,document.dispatchEvent(Br),Hr&&requestAnimationFrame(R)}function C(o,r){return Math.floor(Math.random()*(r-o+1)+o)}function M(o,r){var e=o%(r||16);return(o-e)/(r||16)}function T(o,r,e){return r*e+o}function X(o,r){if("object"==typeof r){for(var e=0;e<o.length;e++){var n=!0;if("object"==typeof o[e]){for(var t in r)if(o[e][t]!==r[t]){n=!1;break}if(n===!0)return e}}return-1}return o.indexOf(r)}function Y(o){return~~(.5+o)}function W(o){for(var r in Ur)Ur[r]===o.keyCode&&o.preventDefault();Er[o.keyCode]!==o.type&&o.keyCode===Ur.space&&(jr.jumping=1),Er[o.keyCode]=o.type,o.keyCode===Ur.d?jr.xDirection=1:o.keyCode===Ur.a&&(jr.xDirection=-1)}function F(o){for(var r in Ur)Ur[r]===o.keyCode&&o.preventDefault();Er[o.keyCode]!==o.type&&o.keyCode===Ur.space&&(jr.jumping=0),Er[o.keyCode]=o.type,(o.keyCode===Ur.d||o.keyCode===Ur.a)&&(Er[Ur.d]&&Er[Ur.a]?Er[Ur.d]===o.type&&Er[Ur.a]===o.type&&(jr.xDirection=0):jr.xDirection=0)}function A(o){Gr.length=o.length}function D(o,r,e,n){Gr.length=0;for(var t=0,a=0;r>a;a++)for(var l=0;e>l;l++)0===n&&(t=T(a,l,10)),1===n&&(t=T(l,r-a-1,10)),2===n&&(t=T(r-a-1,e-l-1,10)),3===n&&(t=T(e-l-1,a,10)),Gr[T(a,l,10)]=o[t];return Gr.slice(0)}function b(){}function k(){for(var o,r=0;Jr>r;r++)for(var e=0;Jr>e;e++){var n=Math.floor(e/10)+"-"+Math.floor(r/10);if(e%10===0||r%10===0){var t=null;Qr[n]||(t=C(0,3),o=E(ie[C(0,9)]),1===Math.floor(e/10)&&1===Math.floor(r/10)&&(o=E(ie[9])),0===Math.floor(e/10)&&0===Math.floor(r/10)&&(o=E(ie[9])),1===Math.floor(e/10)&&0===Math.floor(r/10)&&(o=E(ie[7])),1===Math.floor(e/10)&&1===Math.floor(r/10)&&(o=E(ie[5])),2===Math.floor(e/10)&&1===Math.floor(r/10)&&(o=E(ie[7])),2===Math.floor(e/10)&&2===Math.floor(r/10)&&(o=E(ie[3])),Qr[n]=4&o.options?D(o,10,10,t):o),o=Qr[n]}Vr[T(e,r,Jr)]=o.map[T(e%10,r%10,10)]}}function P(o,r,e){return(r*e||le)+o}function L(o){o.xAccel=o.xAccel+o.xDirection/60*Nr,o.xAccel>o.maxAccel&&(o.xAccel=o.maxAccel),o.xAccel<-o.maxAccel&&(o.xAccel=-o.maxAccel),0===o.xDirection&&(o.xAccel>0?o.xAccel=o.xAccel+-2/60*Nr:o.xAccel<0&&(o.xAccel=o.xAccel+2/60*Nr),(o.xAccel<1/60*Nr&&o.xAccel>-1/60*Nr||1===o.yDirection||-1===o.yDirection)&&(o.xAccel=0)),o.x=o.x+o.xAccel}function H(o){o.jumping&&-1!==o.yDirection&&o.jumpsUsed<o.maxJumps&&(o.maxJumps>1&&0===o.jumpsUsed&&1===o.yDirection&&o.jumpsUsed++,(0===o.jumpsUsed&&0===o.yDirection||o.jumpsUsed>0||o.maxJumps>1)&&(o.yDirection=-1,o.yAccel=-o.jumpForce,o.jumpStart=o.y,o.jumpsUsed++)),(0===o.yDirection||!o.jumping||o.jumpStart-o.y>o.jumpHeight)&&(o.yDirection=1),1===o.yDirection&&(o.jumping=0,o.yAccel=o.yAccel+o.jumpForce/2/60*Nr),0===o.yDirection&&(o.yAccel>0?o.yAccel=o.yAccel+-1/60*Nr:o.yAccel<0&&(o.yAccel=o.yAccel+1/60*Nr),o.yAccel<1/60*Nr&&o.yAccel>-1/60*Nr&&(o.yAccel=0)),o.yAccel>o.maxAccel&&(o.yAccel=10),o.y=o.y+o.yAccel}function B(o){var r=o.x%16,e=T(M(o.x),M(o.y+o.h),oe),n=T(M(o.x+o.w),M(o.y+o.h),oe),t=!1;t=0===r?pe[e]:0!==pe[n]||0!==pe[e],(t||o.y+o.h>16*ee)&&1===o.yDirection&&(o.y=16*M(o.y),o.yAccel=0,o.yDirection=0,o.jumpsUsed=0,o.jumping=0)}function I(o){var r=o.x%16,e=T(M(o.x),M(o.y-o.h/2),oe),n=T(M(o.x+o.w),M(o.y-o.h/2),oe),t=!1;t=0===r?0!==pe[e]:0!==pe[e]||0!==pe[n],t&&1===o.jumping&&(o.y=16*M(o.y),o.yAccel=-1,o.yDirection=1,o.jumping=0)}function S(o){var r=o.y%16,e=o.x%16,n=T(M(o.x),M(o.y-o.h/2),oe),t=T(M(o.x+o.w),M(o.y-o.h/2),oe),a=T(M(o.x),M(o.y),oe),l=T(M(o.x+o.w),M(o.y),oe),i=T(M(o.x),M(o.y+o.h/2),oe),s=T(M(o.x+o.w),M(o.y+o.h/2),oe),d=T(M(o.x),M(o.y+o.h),oe),m=T(M(o.x+o.w),M(o.y+o.h),oe),p=!1,c=!1;0===r?(p=0!==pe[i]||0!==pe[a],c=0!==pe[s]||0!==pe[l]):16*M(o.y+o.h)>o.y+o.h?(p=0!==pe[i]||0!==pe[a]||0!==pe[n],c=0!==pe[s]||0!==pe[l]||0!==pe[t]):(p=0!==pe[i]||0!==pe[a]||0!==pe[d],c=0!==pe[s]||0!==pe[l]||0!==pe[m]),0===e?(c||o.x+o.w>16*re||o.x<0)&&o.xAccel>0&&(o.x=16*M(o.x),o.xAccel=0):(c||o.x+o.w>16*re||o.x<0)&&o.xAccel>0?(o.x=16*M(o.x),o.xAccel=0):(p||o.x+o.w>16*re||o.x<0)&&o.xAccel<0&&(o.x=16*M(o.x+o.w),o.xAccel=0)}function O(o,r,e,n,t,a,l){return{map:l,doors:t,paths:a,options:1*o|2*r|4*e,type:n}}function E(o){return{map:o.map.slice(0),doors:o.doors,paths:o.paths,options:o.options,type:o.type}}function j(o,r,e,n,t,a,l,i,s){for(var d=[],m=[],p=Math.max(o,r),c=0;p*p>c;c++)d[c]=0;d=s(d,o,r,p);for(var u,h=[],g=0;10*p>g;g++)for(var f=0;10*p>f;f++){var y=T(Math.floor(f/10),Math.floor(g/10),p),w=Math.floor(f/10)+"-"+Math.floor(g/10);if(f%10===0||g%10===0){var x=null;h[w]||(x=C(0,3),u=E(ie[d[y]]),h[w]=4&u.options?t(u,10,10,x):u),u=h[w]}m[T(f,g,10*p)]=u.map[T(f%10,g%10,10)]}return oe=10*p,pe=m,ee=10*p,re=10*p,ne=10*r*16,te=10*o*16,{map:m,doors:l,paths:i,width:o,height:r,size:p,options:1*e|2*n|4*t,type:a}}function N(o,r,e,n,t,a,l,i,s,d){i.length=0;for(var m=0;m<ie.length;m++)l[m]=m;var p=a[T(e,n-1,t)],c=a[T(e-1,n,t)],u=a[T(e+1,n,t)],h=a[T(e,n+1,t)];if(0>n-1&&(p=-1),0>e-1&&(c=-1),n+1>d-1&&(h=-1),e+1>s-1&&(u=-1),4===p||2===p||6===p||7===p||9===p||13===p){console.warn("Room for Above");for(var g=0;g<l.length;g++)l[g]=-1;l[2]=2,l[3]=3,l[5]=5,l[8]=8,l[9]=9,-1!==c&&(1===c||3===c||4===c||5===c||6===c||9===c||10===c)&&(console.warn("Room for Above and Left"),l[2]=-1,l[5]=-1,l[3]=3,l[8]=8,l[9]=9,-1!==u&&(1===u||3===u||4===u||7===u||8===u||9===u||11===u)&&(l[8]=-1)),-1!==u&&(1===u||3===u||4===u||7===u||8===u||9===u||11===u)&&(console.warn("Room for Above and Left"),l[2]=-1,l[8]=-1,l[3]=3,l[5]=5,l[9]=9,-1!==c&&(1===c||3===c||4===c||5===c||6===c||9===c||10===c)&&(l[5]=-1))}if(0===e&&(console.warn("Left of Map"),l[7]=-1,l[8]=-1,l[1]=-1),e===s-1&&(console.warn("Right of Map"),l[5]=-1,l[6]=-1,l[1]=-1),0===n&&(console.warn("Top of Map"),l[3]=-1,l[5]=-1,l[8]=-1,l[2]=-1),n===d-1&&(console.warn("Bottom of Map"),l[4]=-1,l[6]=-1,l[7]=-1,l[2]=-1),e===o&&n===r){console.warn("Room for Start");for(var g=0;g<l.length;g++)l[g]=-1;l[10]=10,l[11]=11,l[12]=12,l[13]=13,-1===c&&(l[11]=-1),-1===p&&(l[12]=-1),-1===u&&(l[10]=-1),-1===h&&(l[13]=-1)}else l[10]=-1,l[11]=-1,l[12]=-1,l[13]=-1;l[9]=9;for(var g=0;g<l.length;g++)-1!==l[g]&&i.push(l[g]);var f=i[C(0,i.length-1)];11===f&&-1===[1,3,4,5,6,9].indexOf(c)&&N(o,r,e-1,n,t,a,l,i,s,d),12===f&&-1===[2,4,6,7,9].indexOf(p)&&N(o,r,e,n-1,t,a,l,i,s,d),a[T(e,n,t)]=f}function z(){var o=Wr.canvas,r=o.width/2,e=o.height/2;jr.x-qr+r>o.width?qr=jr.x-(o.width-r):jr.x-r<qr&&(qr=jr.x-r),jr.y-Kr+e>o.height?Kr=jr.y-(o.height-e):jr.y-e<Kr&&(Kr=jr.y-e),Kr=~~(.5+Kr),Kr=~~(.5+Kr)}function U(o,r,e){Xe.frontiers.length=0,Xe.frontiers.push({x:o,y:r}),Xe.currentRegion=e,Xe.regions.push(e)}function V(o){for(var r=!0,e=q(),n=[];r;){var t=0,a=J(e);n.length=0,n.push(nr(a.x-1,a.y),nr(a.x+1,a.y),nr(a.x,a.y-1),nr(a.x,a.y+1));for(var l=0;4>l;l++)null===n[l]&&t++;t>2&&(r=!1)}U(a.x,a.y,o)}function J(o){var r=C(0,o.length-1);return o[r]}function q(){for(var o=[],r=0;r<Xe.rooms.length;r++)o=K(o,Xe.rooms[r]);return o}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapX;n<r.mapY+r.mapH;)G(n,r.mapX-1,1,1)&&o.push({x:n,y:r.mapX-1}),G(n,r.mapX+r.mapW,1,1)&&o.push({x:n,y:r.mapX+r.mapW}),n++;return o}function G(o,r,e,n){return Q(o,r,e,n)&&!Z(o,r,e,n)}function Q(o,r,e,n){return o>0&&r>0&&o+e<Xe.width&&r+n<Xe.height}function Z(o,r,e,n){for(var t=null,a=0;a<Xe.rooms.length;){t=Xe.rooms[a];{if(!(t.mapX>o+e-1||t.mapX+t.mapW-1<o||t.mapY>r+n-1||t.mapY+t.mapH-1<r))return!0;a++}}return!1}function $(o){for(var r=0,e=null,n=!1,t=100;Xe.rooms.length>1&&!n;){r=0,r+=_(o),r+=or(o),r+=rr(o),r+=er(o),1===o.region.rooms.length&&r>0&&(n=!0);for(var a=0;a<o.doors.length;a++)e=o.doors[a],cr(e,o).region===o.region&&(n=!0);t--,0===t&&(n=!0)}}function _(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY-1),null!==e&&t.push({x:a,y:o.mapY,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].room2===r.other&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"N",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y-1,"S",r.other,o)),l++)}return l}function or(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY+o.mapH),null!==e&&t.push({x:a,y:o.mapY+o.mapH-1,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].room2===r.other&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"S",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y+1,"N",r.other,o)),l++)}return l}function rr(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX-1,a),null!==e&&t.push({x:o.mapX,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].room2===r.other&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"W",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x-1,r.y,"E",r.other,o)),l++)}return l}function er(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX+o.mapW,a),null!==e&&t.push({x:o.mapX+o.mapW-1,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].room2===r.other&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"E",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x+1,r.y,"W",r.other,o)),l++)}return l}function nr(o,r){for(var e=null,n=0;n<Xe.rooms.length;){e=Xe.rooms[n];{if(!(e.mapX>o||e.mapX+e.mapW-1<o||e.mapY>r||e.mapY+e.mapH-1<r))return e;n++}}return null}function tr(o){for(var r=0,e=Xe.rooms.length;r++<10*o&&Xe.rooms.length<e+o;)ar()}function ar(){var o=J(Xe.frontiers);try{lr(sr(o.x,o.y))}catch(r){console.log(Xe,o,r)}}function lr(o){if(null===o||!G(o.mapX,o.mapY,o.mapW,o.mapH))return!1;var r=[];r=ir(r,o),Xe.frontiers=K(r,o),0===Xe.frontiers.length&&console.log(r,o,K(r,o)),o.mapColor=Xe.currentRegion.color,Xe.rooms.push(o),Xe.currentRegion.rooms.push(o),$(o)}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapY;n<r.mapY+r.mapH;)G(r.mapX-1,n,1,1)&&o.push({x:r.mapX-1,y:n}),G(r.mapX+r.mapW,n,1,1)&&o.push({x:r.mapX+r.mapW,y:n}),n++;return o}function ir(o,r){for(var e=0;e<Xe.frontiers.length;e++)Xe.frontiers[e].x>=r.mapX-1&&Xe.frontiers[e].x<=r.mapX+r.mapW&&Xe.frontiers[e].y>=r.mapY&&Xe.frontiers[e].y<=r.mapY+r.mapH-1||Xe.frontiers[e].x>=r.mapX&&Xe.frontiers[e].x<=r.mapX+r.mapW-1&&Xe.frontiers[e].y>=r.mapY-1&&Xe.frontiers[e].y<=r.mapY+r.mapH||o.push(Xe.frontiers[e]);return o}function sr(o,r){for(var e=0,n=1,t=1;e++<25&&(n<Xe.currentRegion.maxW||t<Xe.currentRegion.maxH)&&Math.random()<.9;)switch(parseInt(4*Math.random())){case 0:t<Xe.currentRegion.maxH&&G(o,r-1,n,t+1)&&(r--,t++);continue;case 1:t<Xe.currentRegion.maxH&&G(o,r,n,t+1)&&t++;continue;case 2:n<Xe.currentRegion.maxW&&G(o-1,r,n+1,t)&&(o--,n++);continue;case 3:n<Xe.currentRegion.maxW&&G(o,r,n+1,t)&&n++;continue;default:continue}return O(o,r,n,t,Xe.currentRegion)}function O(o,r,e,n,t){return{mapX:o,mapY:r,mapW:e,mapH:n,mapColor:4281545727,region:t,specialType:0,doors:[]}}function dr(o,r,e,n,t){return{mapX:o,mapY:r,doorType:0,dir:e,room1:n,room2:t}}function mr(){for(var o=null,r=null,e=0;e<Xe.rooms.length;e++){o=Xe.rooms[e],o.specialType=0;for(var n=0;n<o.doors.length;n++)r=o.doors[n],r.doorType=0}}function pr(){var o=null,r=[],e=null,n=null,t=null,a=null,l=[],i=[],s=[];s.push(Xe.regions[0]);for(var d=0;s.length>0;){d++,r.length=0,e=s.shift(),i.push(e),t=J(e.rooms),t.specialType=d%Ae.length;for(var m=0;m<e.rooms.length;m++){a=e.rooms[m];for(var p=0;p<a.doors.length;p++)o=a.doors[p],n=cr(o,a).region,n!==e&&o.doorType<=0&&(r.indexOf(n)>=0?l.push(o):(o.doorType=d%Ae.length,r.push(n),-1===i.indexOf(n)&&-1===s.indexOf(n)&&s.push(n)))}}for(var c=0;c<l.length;c++)o=l[c],o.doorType<=0&&(o.doorType=parseInt(Math.random()*(d%Ae.length))+1)}function cr(o,r){return o.room1===r?o.room2:o.room1}function ur(){Xe={width:0,height:0,rooms:[],frontiers:[],regions:[],currentRegion:0},currentRegionColorIndex=0,Xe.width=80,Xe.height=48,U(40,24,hr()),tr(1)}function hr(){var o=gr(Ae[currentRegionColorIndex],parseInt(3*Math.random())+parseInt(3*Math.random())+1,parseInt(3*Math.random())+parseInt(3*Math.random())+1);return currentRegionColorIndex=(currentRegionColorIndex+1)%Ae.length,o}function gr(o,r,e){return{color:o,maxW:r,maxH:e,rooms:[]}}function fr(){ur(),s()}function yr(){ar(),s()}function wr(){V(hr())}function xr(){mr(),pr(),s()}function U(o,r,e){Xe.frontiers.length=0,Xe.frontiers.push({x:o,y:r}),Xe.currentRegion=e,Xe.regions.push(e)}function V(o){var r=J(q());U(r.x,r.y,o)}function J(o){var r=C(0,o.length-1);return o[r]}function q(){for(var o=[],r=0;r<Xe.rooms.length;r++)o=K(o,Xe.rooms[r]);return o}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapX;n<r.mapY+r.mapH;)G(n,r.mapX-1,1,1)&&o.push({x:n,y:r.mapX-1}),G(n,r.mapX+r.mapW,1,1)&&o.push({x:n,y:r.mapX+r.mapW}),n++;return o}function G(o,r,e,n){return Q(o,r,e,n)&&!Z(o,r,e,n)}function Q(o,r,e,n){return o>0&&r>0&&o+e<Xe.width&&r+n<Xe.height}function Z(o,r,e,n){for(var t=null,a=0;a<Xe.rooms.length;){t=Xe.rooms[a];{if(!(t.mapX>o+e-1||t.mapX+t.mapW-1<o||t.mapY>r+n-1||t.mapY+t.mapH-1<r))return!0;a++}}return!1}function $(o){for(var r=0,e=null,n=!1,t=100;Xe.rooms.length>1&&!n;){r=0,r+=_(o),r+=or(o),r+=rr(o),r+=er(o),1===o.region.rooms.length&&r>0&&(n=!0);for(var a=0;a<o.doors.length;a++)e=o.doors[a],cr(e,o).region===o.region&&(n=!0);t--,0===t&&(n=!0)}}function _(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY-1),null!==e&&t.push({x:a,y:o.mapY,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"N",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y-1,"S",r.other,o)),l++)}return l}function or(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY+o.mapH),null!==e&&t.push({x:a,y:o.mapY+o.mapH-1,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"S",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y+1,"N",r.other,o)),l++)}return l}function rr(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX-1,a),null!==e&&t.push({x:o.mapX,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"W",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x-1,r.y,"E",r.other,o)),l++)}return l}function er(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX+o.mapW,a),null!==e&&t.push({x:o.mapX+o.mapW-1,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"E",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x+1,r.y,"W",r.other,o)),l++)}return l}function nr(o,r){for(var e=null,n=0;n<Xe.rooms.length;){e=Xe.rooms[n];{if(!(e.mapX>o||e.mapX+e.mapW-1<o||e.mapY>r||e.mapY+e.mapH-1<r))return e;n++}}return null}function tr(o){for(var r=0,e=Xe.rooms.length;r++<10*o&&Xe.rooms.length<e+o;)ar()}function ar(){var o=J(Xe.frontiers);try{lr(sr(o.x,o.y))}catch(r){console.log(Xe,o,r)}}function lr(o){if(null===o||!G(o.mapX,o.mapY,o.mapW,o.mapH))return!1;var r=[];r=ir(r,o),Xe.frontiers=K(r,o),0===Xe.frontiers.length&&console.log(r,o,K(r,o)),o.mapColor=Xe.currentRegion.color,Xe.rooms.push(o),Xe.currentRegion.rooms.push(o),$(o)}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapY;n<r.mapY+r.mapH;)G(r.mapX-1,n,1,1)&&o.push({x:r.mapX-1,y:n}),G(r.mapX+r.mapW,n,1,1)&&o.push({x:r.mapX+r.mapW,y:n}),n++;return o}function ir(o,r){for(var e=0;e<Xe.frontiers.length;e++)Xe.frontiers[e].x>=r.mapX-1&&Xe.frontiers[e].x<=r.mapX+r.mapW&&Xe.frontiers[e].y>=r.mapY&&Xe.frontiers[e].y<=r.mapY+r.mapH-1||Xe.frontiers[e].x>=r.mapX&&Xe.frontiers[e].x<=r.mapX+r.mapW-1&&Xe.frontiers[e].y>=r.mapY-1&&Xe.frontiers[e].y<=r.mapY+r.mapH||o.push(Xe.frontiers[e]);return o}function sr(o,r){for(var e=0,n=1,t=1;e++<25&&(n<Xe.currentRegion.maxW||t<Xe.currentRegion.maxH)&&Math.random()<.9;)switch(parseInt(4*Math.random())){case 0:t<Xe.currentRegion.maxH&&G(o,r-1,n,t+1)&&(r--,t++);continue;case 1:t<Xe.currentRegion.maxH&&G(o,r,n,t+1)&&t++;continue;case 2:n<Xe.currentRegion.maxW&&G(o-1,r,n+1,t)&&(o--,n++);continue;case 3:n<Xe.currentRegion.maxW&&G(o,r,n+1,t)&&n++;continue;default:continue}return O(o,r,n,t,Xe.currentRegion)}function O(o,r,e,n,t){return{mapX:o,mapY:r,mapW:e,mapH:n,mapColor:4281545727,region:t,specialType:0,doors:[]}}function dr(o,r,e,n,t){return{mapX:o,mapY:r,doorType:0,dir:e,room1:n,room2:t}}function mr(){for(var o=null,r=null,e=0;e<Xe.rooms.length;e++){o=Xe.rooms[e],o.specialType=0;for(var n=0;n<o.doors.length;n++)r=o.doors[n],r.doorType=0}}function pr(){var o=null,r=[],e=null,n=null,t=null,a=null,l=[],i=[],s=[];s.push(Xe.regions[0]);for(var d=0;s.length>0;){d++,r.length=0,e=s.shift(),i.push(e),t=J(e.rooms),t.specialType=d%Ae.length;for(var m=0;m<e.rooms.length;m++){a=e.rooms[m];for(var p=0;p<a.doors.length;p++)o=a.doors[p],n=cr(o,a).region,n!==e&&o.doorType<=0&&(r.indexOf(n)>=0?l.push(o):(o.doorType=d%Ae.length,r.push(n),-1===i.indexOf(n)&&-1===s.indexOf(n)&&s.push(n)))}}for(var c=0;c<l.length;c++)o=l[c],o.doorType<=0&&(o.doorType=parseInt(Math.random()*(d%Ae.length))+1)}function cr(o,r){return o.room1===r?o.room2:o.room1}function ur(){Xe={width:0,height:0,rooms:[],frontiers:[],regions:[],currentRegion:0},currentRegionColorIndex=0,Xe.width=80,Xe.height=48,U(40,24,hr()),tr(2)}function hr(){var o=gr(Ae[currentRegionColorIndex],parseInt(3*Math.random())+parseInt(3*Math.random())+1,parseInt(3*Math.random())+parseInt(3*Math.random())+1);return currentRegionColorIndex=(currentRegionColorIndex+1)%Ae.length,o}function gr(o,r,e){return{color:o,maxW:r,maxH:e,rooms:[]}}function fr(){ur(),s()}function yr(){ar(),s()}function wr(){V(hr())}function xr(){mr(),pr(),s()}function U(o,r,e){Xe.frontiers.length=0,Xe.frontiers.push({x:o,y:r}),Xe.currentRegion=e,Xe.regions.push(e)}function V(o){var r=J(q());U(r.x,r.y,o)}function J(o){var r=C(0,o.length-1);return o[r]}function q(){for(var o=[],r=0;r<Xe.rooms.length;r++)o=K(o,Xe.rooms[r]);return o}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapX;n<r.mapY+r.mapH;)G(n,r.mapX-1,1,1)&&o.push({x:n,y:r.mapX-1}),G(n,r.mapX+r.mapW,1,1)&&o.push({x:n,y:r.mapX+r.mapW}),n++;return o}function G(o,r,e,n){return Q(o,r,e,n)&&!Z(o,r,e,n)
}function Q(o,r,e,n){return o>0&&r>0&&o+e<Xe.width&&r+n<Xe.height}function Z(o,r,e,n){for(var t=null,a=0;a<Xe.rooms.length;){t=Xe.rooms[a];{if(!(t.mapX>o+e-1||t.mapX+t.mapW-1<o||t.mapY>r+n-1||t.mapY+t.mapH-1<r))return!0;a++}}return!1}function $(o){for(var r=0,e=null,n=!1,t=100;Xe.rooms.length>1&&!n;){r=0,r+=_(o),r+=or(o),r+=rr(o),r+=er(o),1===o.region.rooms.length&&r>0&&(n=!0);for(var a=0;a<o.doors.length;a++)e=o.doors[a],cr(e,o).region===o.region&&(n=!0);t--,0===t&&(n=!0)}}function _(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY-1),null!==e&&t.push({x:a,y:o.mapY,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"N",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y-1,"S",r.other,o)),l++)}return l}function or(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY+o.mapH),null!==e&&t.push({x:a,y:o.mapY+o.mapH-1,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"S",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y+1,"N",r.other,o)),l++)}return l}function rr(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX-1,a),null!==e&&t.push({x:o.mapX,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"W",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x-1,r.y,"E",r.other,o)),l++)}return l}function er(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX+o.mapW,a),null!==e&&t.push({x:o.mapX+o.mapW-1,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"E",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x+1,r.y,"W",r.other,o)),l++)}return l}function nr(o,r){for(var e=null,n=0;n<Xe.rooms.length;){e=Xe.rooms[n];{if(!(e.mapX>o||e.mapX+e.mapW-1<o||e.mapY>r||e.mapY+e.mapH-1<r))return e;n++}}return null}function tr(o){for(var r=0,e=Xe.rooms.length;r++<10*o&&Xe.rooms.length<e+o;)ar()}function ar(){var o=J(Xe.frontiers);try{lr(sr(o.x,o.y))}catch(r){console.log(Xe,o,r)}}function lr(o){if(null===o||!G(o.mapX,o.mapY,o.mapW,o.mapH))return!1;var r=[];r=ir(r,o),Xe.frontiers=K(r,o),0===Xe.frontiers.length&&console.log(r,o,K(r,o)),o.mapColor=Xe.currentRegion.color,Xe.rooms.push(o),Xe.currentRegion.rooms.push(o),$(o)}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapY;n<r.mapY+r.mapH;)G(r.mapX-1,n,1,1)&&o.push({x:r.mapX-1,y:n}),G(r.mapX+r.mapW,n,1,1)&&o.push({x:r.mapX+r.mapW,y:n}),n++;return o}function ir(o,r){for(var e=0;e<Xe.frontiers.length;e++)Xe.frontiers[e].x>=r.mapX-1&&Xe.frontiers[e].x<=r.mapX+r.mapW&&Xe.frontiers[e].y>=r.mapY&&Xe.frontiers[e].y<=r.mapY+r.mapH-1||Xe.frontiers[e].x>=r.mapX&&Xe.frontiers[e].x<=r.mapX+r.mapW-1&&Xe.frontiers[e].y>=r.mapY-1&&Xe.frontiers[e].y<=r.mapY+r.mapH||o.push(Xe.frontiers[e]);return o}function sr(o,r){for(var e=0,n=1,t=1;e++<25&&(n<Xe.currentRegion.maxW||t<Xe.currentRegion.maxH)&&Math.random()<.9;)switch(parseInt(4*Math.random())){case 0:t<Xe.currentRegion.maxH&&G(o,r-1,n,t+1)&&(r--,t++);continue;case 1:t<Xe.currentRegion.maxH&&G(o,r,n,t+1)&&t++;continue;case 2:n<Xe.currentRegion.maxW&&G(o-1,r,n+1,t)&&(o--,n++);continue;case 3:n<Xe.currentRegion.maxW&&G(o,r,n+1,t)&&n++;continue;default:continue}return O(o,r,n,t,Xe.currentRegion)}function O(o,r,e,n,t){return{mapX:o,mapY:r,mapW:e,mapH:n,mapColor:4281545727,region:t,specialType:0,doors:[]}}function dr(o,r,e,n,t){return{mapX:o,mapY:r,doorType:0,dir:e,room1:n,room2:t}}function mr(){for(var o=null,r=null,e=0;e<Xe.rooms.length;e++){o=Xe.rooms[e],o.specialType=0;for(var n=0;n<o.doors.length;n++)r=o.doors[n],r.doorType=0}}function pr(){var o=null,r=[],e=null,n=null,t=null,a=null,l=[],i=[],s=[];s.push(Xe.regions[0]);for(var d=0;s.length>0;){d++,r.length=0,e=s.shift(),i.push(e),t=J(e.rooms),t.specialType=d%Ae.length;for(var m=0;m<e.rooms.length;m++){a=e.rooms[m];for(var p=0;p<a.doors.length;p++)o=a.doors[p],n=cr(o,a).region,n!==e&&o.doorType<=0&&(r.indexOf(n)>=0?l.push(o):(o.doorType=d%Ae.length,r.push(n),-1===i.indexOf(n)&&-1===s.indexOf(n)&&s.push(n)))}}for(var c=0;c<l.length;c++)o=l[c],o.doorType<=0&&(o.doorType=parseInt(Math.random()*(d%Ae.length))+1)}function cr(o,r){return o.room1===r?o.room2:o.room1}function ur(){Xe={width:0,height:0,rooms:[],frontiers:[],regions:[],currentRegion:0},currentRegionColorIndex=0,Xe.width=80,Xe.height=48,U(40,24,hr()),tr(2)}function hr(){var o=gr(Ae[currentRegionColorIndex],parseInt(3*Math.random())+parseInt(3*Math.random())+1,parseInt(3*Math.random())+parseInt(3*Math.random())+1);return currentRegionColorIndex=(currentRegionColorIndex+1)%Ae.length,o}function gr(o,r,e){return{color:o,maxW:r,maxH:e,rooms:[]}}function fr(){ur(),s()}function yr(){ar(),s()}function wr(){V(hr())}function xr(){mr(),pr(),s()}function U(o,r,e){Xe.frontiers.length=0,Xe.frontiers.push({x:o,y:r}),Xe.currentRegion=e,Xe.regions.push(e)}function V(o){for(var r,e=!0,n=q(),t=[];e;){var a=0;r=J(n),t.length=0,t.push(nr(r.x-1,r.y),nr(r.x+1,r.y),nr(r.x,r.y-1),nr(r.x,r.y+1));for(var l=0;4>l;l++)null===t[l]&&a++;a>2&&(e=!1)}U(r.x,r.y,o)}function J(o){var r=C(0,o.length-1);return o[r]}function q(){for(var o=[],r=0;r<Xe.rooms.length;r++)o=K(o,Xe.rooms[r]);return o}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapX;n<r.mapY+r.mapH;)G(n,r.mapX-1,1,1)&&o.push({x:n,y:r.mapX-1}),G(n,r.mapX+r.mapW,1,1)&&o.push({x:n,y:r.mapX+r.mapW}),n++;return o}function G(o,r,e,n){return Q(o,r,e,n)&&!Z(o,r,e,n)}function Q(o,r,e,n){return o>0&&r>0&&o+e<Xe.width&&r+n<Xe.height}function Z(o,r,e,n){for(var t=null,a=0;a<Xe.rooms.length;){t=Xe.rooms[a];{if(!(t.mapX>o+e-1||t.mapX+t.mapW-1<o||t.mapY>r+n-1||t.mapY+t.mapH-1<r))return!0;a++}}return!1}function $(o){for(var r=0,e=null,n=!1,t=100;Xe.rooms.length>1&&!n;){r=0,r+=_(o),r+=or(o),r+=rr(o),r+=er(o),1===o.region.rooms.length&&r>0&&(n=!0);for(var a=0;a<o.doors.length;a++)e=o.doors[a],cr(e,o).region===o.region&&(n=!0);t--,0===t&&(n=!0)}}function _(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY-1),null!==e&&t.push({x:a,y:o.mapY,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"N",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y-1,"S",r.other,o)),l++)}return l}function or(o){for(var r=null,e=null,n=null,t=[],a=o.mapX;a<o.mapX+o.mapW;)e=nr(a,o.mapY+o.mapH),null!==e&&t.push({x:a,y:o.mapY+o.mapH-1,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"S",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x,r.y+1,"N",r.other,o)),l++)}return l}function rr(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX-1,a),null!==e&&t.push({x:o.mapX,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"W",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x-1,r.y,"E",r.other,o)),l++)}return l}function er(o){for(var r=null,e=null,n=null,t=[],a=o.mapY;a<o.mapY+o.mapH;)e=nr(o.mapX+o.mapW,a),null!==e&&t.push({x:o.mapX+o.mapW-1,y:a,other:e}),a++;for(var l=0,i=0;i<t.length;i++){r=t[i];for(var s=!1,d=0;d<o.doors.length;d++)o.doors[d].x===r.x&&o.doors[d].y===r.y&&(s=!0);Math.random()>We||X(o.doors,r)>=0||s||(n=dr(r.x,r.y,"E",o,r.other),o.doors.push(n),r.other.doors.push(dr(r.x+1,r.y,"W",r.other,o)),l++)}return l}function nr(o,r){for(var e=null,n=0;n<Xe.rooms.length;){e=Xe.rooms[n];{if(!(e.mapX>o||e.mapX+e.mapW-1<o||e.mapY>r||e.mapY+e.mapH-1<r))return e;n++}}return null}function tr(o){for(var r=0,e=Xe.rooms.length;r++<10*o&&Xe.rooms.length<e+o;)ar()}function ar(){if(Xe.frontiers.length>0){var o=J(Xe.frontiers);try{lr(sr(o.x,o.y))}catch(r){console.log(Xe,o,r)}}}function lr(o){if(null===o||!G(o.mapX,o.mapY,o.mapW,o.mapH))return!1;var r=[];r=ir(r,o),Xe.frontiers=K(r,o),0===Xe.frontiers.length&&console.log(r,o,K(r,o)),o.mapColor=Xe.currentRegion.color,Xe.rooms.push(o),Xe.currentRegion.rooms.push(o),$(o)}function K(o,r){for(var e=r.mapX;e<r.mapX+r.mapW;)G(e,r.mapY-1,1,1)&&o.push({x:e,y:r.mapY-1}),G(e,r.mapY+r.mapH,1,1)&&o.push({x:e,y:r.mapY+r.mapH}),e++;for(var n=r.mapY;n<r.mapY+r.mapH;)G(r.mapX-1,n,1,1)&&o.push({x:r.mapX-1,y:n}),G(r.mapX+r.mapW,n,1,1)&&o.push({x:r.mapX+r.mapW,y:n}),n++;return o}function ir(o,r){for(var e=0;e<Xe.frontiers.length;e++)Xe.frontiers[e].x>=r.mapX-1&&Xe.frontiers[e].x<=r.mapX+r.mapW&&Xe.frontiers[e].y>=r.mapY&&Xe.frontiers[e].y<=r.mapY+r.mapH-1||Xe.frontiers[e].x>=r.mapX&&Xe.frontiers[e].x<=r.mapX+r.mapW-1&&Xe.frontiers[e].y>=r.mapY-1&&Xe.frontiers[e].y<=r.mapY+r.mapH||o.push(Xe.frontiers[e]);return o}function sr(o,r){for(var e=0,n=1,t=1;e++<25&&(n<Xe.currentRegion.maxW||t<Xe.currentRegion.maxH)&&Math.random()<.9;)switch(parseInt(4*Math.random())){case 0:t<Xe.currentRegion.maxH&&G(o,r-1,n,t+1)&&(r--,t++);continue;case 1:t<Xe.currentRegion.maxH&&G(o,r,n,t+1)&&t++;continue;case 2:n<Xe.currentRegion.maxW&&G(o-1,r,n+1,t)&&(o--,n++);continue;case 3:n<Xe.currentRegion.maxW&&G(o,r,n+1,t)&&n++;continue;default:continue}return O(o,r,n,t,Xe.currentRegion)}function O(o,r,e,n,t){return{mapX:o,mapY:r,mapW:e,mapH:n,mapColor:4281545727,region:t,specialType:0,doors:[]}}function dr(o,r,e,n,t){return{mapX:o,mapY:r,doorType:0,dir:e,room1:n,room2:t}}function mr(){for(var o=null,r=null,e=0;e<Xe.rooms.length;e++){o=Xe.rooms[e],o.specialType=0;for(var n=0;n<o.doors.length;n++)r=o.doors[n],r.doorType=0}}function pr(){var o=null,r=[],e=null,n=null,t=null,a=null,l=[],i=[],s=[];s.push(Xe.regions[0]);for(var d=0;s.length>0;){d++,r.length=0,e=s.shift(),i.push(e),t=J(e.rooms),t.specialType=d%Ae.length;for(var m=0;m<e.rooms.length;m++){a=e.rooms[m];for(var p=0;p<a.doors.length;p++)o=a.doors[p],n=cr(o,a).region,n!==e&&o.doorType<=0&&(r.indexOf(n)>=0?l.push(o):(o.doorType=d%Ae.length,r.push(n),-1===i.indexOf(n)&&-1===s.indexOf(n)&&s.push(n)))}}for(var c=0;c<l.length;c++)o=l[c],o.doorType<=0&&(o.doorType=parseInt(Math.random()*(d%Ae.length))+1)}function cr(o,r){return o.room1===r?o.room2:o.room1}function ur(){Xe={width:0,height:0,rooms:[],frontiers:[],regions:[],currentRegion:0},currentRegionColorIndex=0,Xe.width=80,Xe.height=48,U(40,24,hr()),tr(2)}function hr(){var o=gr(Ae[currentRegionColorIndex],parseInt(3*Math.random())+parseInt(3*Math.random())+1,parseInt(3*Math.random())+parseInt(3*Math.random())+1);return currentRegionColorIndex=(currentRegionColorIndex+1)%Ae.length,o}function gr(o,r,e){return{color:o,maxW:r,maxH:e,rooms:[]}}function fr(){ur(),s()}function yr(){ar(),s()}function wr(){V(hr())}function xr(){mr(),pr(),s()}var vr={player:{},border:{},tile:{}},Rr=0,Cr=[],vr={player:{},border:{},tile:{}},Rr=0,Cr=[],vr={player:{},border:{},tile:{}},Rr=0,Cr=[],Mr,Tr,Xr,Yr,Wr,Fr,Ar,Dr,br=["getElementById","querySelector","querySelectorAll"],kr=0,Pr=1,Lr=2,Hr=!0,Br=new CustomEvent("frame"),Ir=window.performance.now(),Sr=window.performance.now(),Or={},Er={},jr={x:151,y:48,w:16,h:32,img:null,xDirection:0,yDirection:1,xAccel:0,yAccel:0,maxAccel:5,jumpForce:7,jumpHeight:50,jumpStart:0,jumping:0,jumpsUsed:0,maxJumps:3,angle:0,health:5,maxHealth:5},Nr=Ir-Sr,zr=[jr],Ur={a:65,w:87,s:83,d:68,space:32,shift:16,ctrl:17,alt:18,tab:9,debug:192};h("keydown",W),h("keyup",F),h("resize",x),h("DOMContentLoaded",w),h("frame",v),window.addEventListener("resize",f),document.addEventListener("DOMContentLoaded",f),document.addEventListener("mousedown",f),document.addEventListener("mouseup",f),document.addEventListener("keydown",f),document.addEventListener("keyup",f),document.addEventListener("frame",f);for(var Vr=[],Jr=30,qr=0,Kr=0,Gr=[],Qr={},Zr=[0,1],$r=[],_r={w:16,h:16,img:null,angle:0},oe=0,re=0,ee=0,ne=0,te=0,ae=oe,le=oe,ie=[],se=[],de=[],me=0;100>me;me++)de[me]=0;var pe=null,ce=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],ue=[1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1],he=[1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],ge=[1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1],fe=[1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],ye=[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1],we=[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,0,1,1,1,0,1,1,0,0,0,0,1,1,1,0,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1],xe=[1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],ve=[1,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1],Re=[1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,2,2,0,0,0,0,0,0,0,1,2,2,0,0,0,0,0,0,0,1,2,2,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1],Ce=[1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,2,2,1,1,0,0,0,0,0,0,2,2,1,1,0,0,0,0,0,0,2,2,1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Me=[1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,1,2,2,2,2,1,1,1],Te=[1,1,1,2,2,2,2,1,1,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1];ie.push(O(0,0,0,0,0,15,de)),ie.push(O(0,0,0,1,0,5,ce)),ie.push(O(0,0,0,2,0,10,ue)),ie.push(O(0,0,0,3,0,11,he)),ie.push(O(0,0,0,4,0,13,ge)),ie.push(O(0,0,0,5,0,6,fe)),ie.push(O(0,0,0,6,0,12,ye)),ie.push(O(0,0,0,7,0,9,we)),ie.push(O(0,0,0,8,0,3,xe)),ie.push(O(0,0,0,9,0,15,ve)),ie.push(O(0,0,0,10,1,14,Re)),ie.push(O(0,0,0,11,4,11,Ce)),ie.push(O(0,0,0,12,8,7,Me)),ie.push(O(0,0,0,13,2,13,Te)),se.push(j(4,4,0,0,0,0,0,15,function(o,r,e,n){for(var t=C(0,r-1),a=C(0,e-1),l=(C(0,3),0),i=0,s=[],d=[],m=0;n*n>m;m++)N(t,a,l,i,n,o,s,d,r,e),l++,l>r-1&&(l=0,i++),i>e-1&&(m=n*n);return o}));var Xe,Ye,We=.2,Fe=0,Ae=[{background:"#BBBBBB",border:"#A0A0A0",other:"#CFCFCF",lock:"#FFFFFF"},{background:"#990000",border:"#FF0000",other:"#FF0000",lock:"#FF6666"},{background:"#009900",border:"#00BB00",other:"#00BB00",lock:"#66FF66"},{background:"#000099",border:"#0000FF",other:"#0000FF",lock:"#6666FF"},{background:"#9F9F9F",border:"#555555",other:"#555555",lock:"#B0B0B0"}],Xe,We=.2,Fe=0,Ae=[{background:"#BBBBBB",border:"#A0A0A0",other:"#CFCFCF",lock:"#FFFFFF"},{background:"#990000",border:"#FF0000",other:"#FF0000",lock:"#FF6666"},{background:"#009900",border:"#00BB00",other:"#00BB00",lock:"#66FF66"},{background:"#000099",border:"#0000FF",other:"#0000FF",lock:"#6666FF"},{background:"#9F9F9F",border:"#555555",other:"#555555",lock:"#B0B0B0"}],Xe,Ye,We=.2,Fe=0,Ae=[{background:"#BBBBBB",border:"#A0A0A0",other:"#CFCFCF",lock:"#FFFFFF"},{background:"#990000",border:"#FF0000",other:"#FF0000",lock:"#FF6666"},{background:"#009900",border:"#00BB00",other:"#00BB00",lock:"#66FF66"},{background:"#000099",border:"#0000FF",other:"#0000FF",lock:"#6666FF"},{background:"#9F9F9F",border:"#555555",other:"#555555",lock:"#B0B0B0"}],Xe,Ye,We=.2,Fe=0,Ae=[{background:"#BBBBBB",border:"#A0A0A0",other:"#CFCFCF",lock:"#FFFFFF"},{background:"#990000",border:"#FF0000",other:"#FF0000",lock:"#FF6666"},{background:"#009900",border:"#00BB00",other:"#00BB00",lock:"#66FF66"},{background:"#000099",border:"#0000FF",other:"#0000FF",lock:"#6666FF"},{background:"#9F9F9F",border:"#555555",other:"#555555",lock:"#B0B0B0"}];